# 海报编辑器服务管理脚本使用说明

本项目提供了三种服务管理脚本，支持一键启动、停止、重启海报编辑器服务，适用于不同的操作系统和使用场景。

## 📋 脚本概览

| 脚本文件 | 适用平台 | 特色功能 |
|---------|---------|---------|
| `service.sh` | macOS/Linux | Shell脚本，轻量级，系统兼容性好 |
| `service.bat` | Windows | 批处理脚本，Windows原生支持 |
| `service.js` | 跨平台 | Node.js脚本，功能最完整，推荐使用 |

## 🚀 快速开始

### 方法一：使用 Node.js 脚本（推荐）

```bash
# 启动服务
node service.js start

# 查看状态
node service.js status

# 停止服务
node service.js stop

# 重启服务
node service.js restart
```

### 方法二：使用 Shell 脚本（macOS/Linux）

```bash
# 启动服务
./service.sh start

# 查看状态
./service.sh status

# 停止服务
./service.sh stop

# 重启服务
./service.sh restart
```

### 方法三：使用批处理脚本（Windows）

```cmd
# 启动服务
service.bat start

# 查看状态
service.bat status

# 停止服务
service.bat stop

# 重启服务
service.bat restart
```

## 📖 详细命令说明

### 可用命令

| 命令 | 功能描述 | 示例 |
|------|---------|------|
| `start` | 启动海报编辑器服务 | `node service.js start` |
| `stop` | 停止服务 | `node service.js stop` |
| `restart` | 重启服务（先停止再启动） | `node service.js restart` |
| `status` | 查看服务运行状态 | `node service.js status` |
| `logs` | 查看实时日志输出 | `node service.js logs` |
| `clean` | 清理日志文件 | `node service.js clean` |
| `help` | 显示帮助信息 | `node service.js help` |

### 命令执行流程

#### 启动服务 (`start`)
1. 检查服务是否已运行
2. 验证项目目录结构
3. 检查端口占用情况（默认3000端口）
4. 自动安装依赖（如果`node_modules`不存在）
5. 后台启动React开发服务器
6. 等待服务完全启动
7. 显示访问地址和日志位置

#### 停止服务 (`stop`)
1. 获取服务进程ID
2. 尝试优雅关闭进程
3. 等待进程结束
4. 必要时强制终止进程
5. 清理PID文件

#### 重启服务 (`restart`)
1. 执行停止操作
2. 等待2秒
3. 执行启动操作

## 🔧 配置说明

### 默认配置

```javascript
const CONFIG = {
    SERVICE_NAME: '海报编辑器',
    CLIENT_DIR: './client',          // React项目目录
    PORT: 3000,                      // 服务端口
    PID_FILE: './poster-editor.pid', // 进程ID文件
    LOG_FILE: './poster-editor.log'  // 日志文件
};
```

### 自定义配置

如需修改配置，可以编辑对应的脚本文件：

- **Node.js版本**: 修改 `service.js` 中的 `CONFIG` 对象
- **Shell版本**: 修改 `service.sh` 中的配置变量
- **Windows版本**: 修改 `service.bat` 中的配置变量

## 📝 日志管理

### 日志文件位置
- 默认日志文件：`poster-editor.log`
- 位置：项目根目录

### 查看日志
```bash
# 实时查看日志（按Ctrl+C退出）
node service.js logs

# 或者直接查看日志文件
cat poster-editor.log        # macOS/Linux
type poster-editor.log       # Windows
```

### 清理日志
```bash
# 清空日志文件
node service.js clean
```

## 🛡️ 错误处理

### 常见问题及解决方案

#### 1. 端口被占用
**错误信息**: `❌ 错误: 端口 3000 已被占用`

**解决方案**:
- 停止占用端口的其他服务
- 或修改配置使用其他端口

#### 2. 找不到client目录
**错误信息**: `❌ 错误: 找不到 client 目录`

**解决方案**:
- 确保在项目根目录执行脚本
- 检查目录结构是否正确

#### 3. 依赖安装失败
**错误信息**: `❌ 依赖安装失败`

**解决方案**:
- 检查网络连接
- 清理npm缓存：`npm cache clean --force`
- 手动安装：`cd client && npm install`

#### 4. 服务启动超时
**错误信息**: `❌ 服务启动超时`

**解决方案**:
- 查看日志文件了解详细错误
- 检查系统资源是否充足
- 手动测试：`cd client && npm start`

## 🔍 服务状态监控

### 状态检查
```bash
# 查看服务状态
node service.js status

# 输出示例
✅ 海报编辑器 正在运行 (PID: 12345, Port: 3000)
```

### 进程信息
- **PID文件**: `poster-editor.pid` - 存储服务进程ID
- **日志文件**: `poster-editor.log` - 记录服务运行日志
- **访问地址**: http://localhost:3000

## 🎯 使用建议

### 开发环境
1. **首次使用**: 运行 `node service.js start`
2. **日常开发**: 使用 `node service.js restart` 重启服务
3. **调试问题**: 使用 `node service.js logs` 查看日志

### 生产环境
1. 考虑使用 PM2 等专业进程管理工具
2. 配置自动重启和负载均衡
3. 设置日志轮转和监控

### 团队协作
1. 所有团队成员使用相同的脚本
2. 在项目README中说明使用方法
3. 定期更新脚本以支持新功能

## 🔗 相关文件

- `service.js` - Node.js跨平台服务管理脚本
- `service.sh` - Shell脚本（macOS/Linux）
- `service.bat` - 批处理脚本（Windows）
- `poster-editor.pid` - 服务进程ID文件（运行时生成）
- `poster-editor.log` - 服务日志文件（运行时生成）

## 📞 技术支持

如果在使用过程中遇到问题：

1. 首先查看日志文件 `poster-editor.log`
2. 检查本说明文档中的常见问题解决方案
3. 确保系统环境满足要求（Node.js已安装）
4. 验证项目目录结构完整

---

**注意**: 确保在项目根目录下运行脚本，且已安装Node.js环境。 